<IfModule mod_rewrite.c>
  RewriteEngine On

  # Allow ACME challenges (if needed)
  RewriteRule ^\.well-known/ - [L]

  # Block direct access to non-public folders
  RewriteRule ^(app|config|data|\.git)(/|$) - [F,L]

  # Route everything through /public without exposing /public in the URL
  RewriteRule ^$ public/ [L]
  RewriteCond %{REQUEST_URI} !^/public/
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^(.*)$ public/$1 [L]
</IfModule>
